<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Einstiegen bitte!"><meta name="google-site-verification" content="L7-zLUxhF4WYJprTtGO0jUL7BYmE9BrpzuwU7s_XEJI"><title>Python Encoding System | Chenyu's Script</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-91094510-1','auto');ga('send','pageview');</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Python Encoding System</h1><a id="logo" href="/.">Chenyu's Script</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about.html"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Python Encoding System</h1><div class="post-meta">Jun 8, 2017<span> | </span><span class="category"><a href="/categories/Python/">Python</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a class="disqus-comment-count" data-disqus-identifier="posts/50024/" href="/posts/50024/#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Unicode-and-UTF-8"><span class="toc-number">1.</span> <span class="toc-text">Unicode and UTF-8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unicode-V-S-String"><span class="toc-number">2.</span> <span class="toc-text">Unicode V.S. String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#String-encoding-check"><span class="toc-number">3.</span> <span class="toc-text">String encoding check</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unicode-comparison"><span class="toc-number">4.</span> <span class="toc-text">Unicode comparison</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Local-system-encoding"><span class="toc-number">5.</span> <span class="toc-text">Local system encoding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reading-UTF-8-Files"><span class="toc-number">6.</span> <span class="toc-text">Reading UTF-8 Files</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Reference"><span class="toc-number">7.</span> <span class="toc-text">Reference</span></a></li></ol></div></div><div class="post-content"><p>When dealing with Chinese characters, decoding disorder might be a normal problem, espatially, with cross platform development.</p>
<p>Some error like: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal</span><br></pre></td></tr></table></figure>
<p>occurs normally.</p>
<p>Local environment:<br>Platform: Mac English system<br>Python version: 2.7.10<br>Editor: Sublime 3</p>
<hr>
<h3 id="Unicode-and-UTF-8"><a href="#Unicode-and-UTF-8" class="headerlink" title="Unicode and UTF-8"></a>Unicode and UTF-8</h3><p><code>Unicode</code> is a computing industry standard for the consistent encoding, representation, and handling of text expressed in most of the world’s writing systems. It can be implemented by different character encodings. The Unicode standard defines <code>UTF-8</code>, <code>UTF-16</code>, and <code>UTF-32</code>, and several other encodings are in use. The most commonly used encodings are UTF-8, UTF-16 and UCS-2, a precursor of UTF-16.</p>
<p><code>UTF-8</code>, the most widely used by web-sites, uses one byte for the first 128 code points, and up to 4 bytes for other characters. The first 128 Unicode code points are the <code>ASCII</code> characters; so an <code>ASCII</code> text is a <code>UTF-8</code> text.</p>
<hr>
<h3 id="Unicode-V-S-String"><a href="#Unicode-V-S-String" class="headerlink" title="Unicode V.S. String"></a>Unicode V.S. String</h3><p><code>Unicode</code> is not encoded, text can be encoded in a specific encoding to represent the text as raw bytes(e.g. utf-8, latin-1…).<br><code>str</code> is meaningful string which are human readable.</p>
<p>Create a <code>str</code> (byte string):  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">byteString = <span class="string">"hello world! (in my default locale)"</span></span><br></pre></td></tr></table></figure>
<p>Create a <code>unicode</code> (unicode stirng):  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unicodeString = <span class="string">u"hello Unicode world!"</span></span><br></pre></td></tr></table></figure>
<p>You can think of <code>unicode</code> as a general representation of some text, a lower level of text presentataion, which can be encoded in many different ways into a sequence of binary data represented via <code>str</code>.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">u'à'</span>)  <span class="comment"># a single unicode</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">'à'</span>)   <span class="comment"># by default encoding utf-8 -&gt; takes two bytes</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">u'à'</span></span><br><span class="line"><span class="string">u'\xe0'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">u'à'</span>.encode(<span class="string">'latin1'</span>))  <span class="comment"># `encoding` is to represent a unicode string as a string of bytes</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">u'à'</span>.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="comment"># internal storage of different encoding systems</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">u'à'</span>.encode(<span class="string">'latin1'</span>) <span class="comment"># only takes one byte</span></span><br><span class="line"><span class="string">'\xe0'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">u'à'</span>.encode(<span class="string">'utf-8'</span>) <span class="comment"># takes two bytes</span></span><br><span class="line"><span class="string">'\xc3\xa0'</span></span><br><span class="line"><span class="comment"># to display the meaningful text</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">u'à'</span>.encode(<span class="string">'utf-8'</span>)  <span class="comment"># terminal encoding is utf-8</span></span><br><span class="line">à</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">u'à'</span>.encode(<span class="string">'latin1'</span>) <span class="comment"># terminal cannot understand the latin1 byte</span></span><br><span class="line">�</span><br></pre></td></tr></table></figure>
<p>How to convert <code>str</code> to <code>unicode</code>, and convert it back:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">"hello normal string"</span> <span class="comment"># s is encoded to utf8 by default</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> s</span><br><span class="line">hello normal string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(s)</span><br><span class="line">&lt;type <span class="string">'str'</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>u = s.decode(<span class="string">"UTF-8"</span>) <span class="comment">#  decode s back to unicode form</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(u)</span><br><span class="line">&lt;type <span class="string">'unicode'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>u</span><br><span class="line"><span class="string">u'hello normal string'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>backToBytes = u.encode( <span class="string">"UTF-8"</span> )</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(backToBytes)</span><br><span class="line">&lt;type <span class="string">'str'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>backToBytes</span><br><span class="line"><span class="string">'hello normal string'</span></span><br></pre></td></tr></table></figure>
<p>Note that using <code>str</code> you have a lower-level control on the single bytes of a specific encoding representation, while using <code>unicode</code> you can only control at the code-point level.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'àèìòù'</span></span><br><span class="line"><span class="string">'\xc3\xa0\xc3\xa8\xc3\xac\xc3\xb2\xc3\xb9'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">'àèìòù'</span>.replace(<span class="string">'è'</span>, <span class="string">''</span>)</span><br><span class="line">àìòù</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">'àèìòù'</span>.replace(<span class="string">'\xa8'</span>, <span class="string">''</span>)</span><br><span class="line">à?ìòù</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="String-encoding-check"><a href="#String-encoding-check" class="headerlink" title="String encoding check"></a>String encoding check</h3><p>To check if a obj is <code>str</code> or <code>unicode</code>:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="string">u'中文'</span>, unicode)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="string">'中文'</span>, unicode)</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="string">'中文'</span>, str)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(<span class="string">u'中文'</span>, str)</span><br><span class="line"><span class="keyword">False</span></span><br></pre></td></tr></table></figure>
<p>Don’t <code>decode</code> a <code>unicode</code>, and don’t <code>encode</code> a <code>str</code>.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">u'ö'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.decode()</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">UnicodeEncodeError: <span class="string">'ascii'</span> codec can<span class="string">'t encode character u'</span>\xf6<span class="string">' in position 0:</span></span><br><span class="line"><span class="string">ordinal not in range(128)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; s.encode('</span>ascii<span class="string">')</span></span><br><span class="line"><span class="string">Traceback (most recent call last):</span></span><br><span class="line"><span class="string">  File "&lt;stdin&gt;", line 1, in &lt;module&gt;</span></span><br><span class="line"><span class="string">UnicodeEncodeError: '</span>ascii<span class="string">' codec can'</span>t encode character <span class="string">u'\xf6'</span> <span class="keyword">in</span> position <span class="number">0</span>:</span><br><span class="line">ordinal <span class="keyword">not</span> <span class="keyword">in</span> range(<span class="number">128</span>)</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Unicode-comparison"><a href="#Unicode-comparison" class="headerlink" title="Unicode comparison"></a>Unicode comparison</h3><p>You may use the <code>==</code> operator to compare unicode objects for equality.  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 = <span class="string">u'Hello'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2 = unicode(<span class="string">"Hello"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(s1), type(s2)</span><br><span class="line">(&lt;type <span class="string">'unicode'</span>&gt;, &lt;type <span class="string">'unicode'</span>&gt;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1==s2</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s3=<span class="string">'Hello'</span>.decode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(s3)</span><br><span class="line">&lt;type <span class="string">'unicode'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1==s3</span><br><span class="line"><span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<p>If you compare <code>unicode</code> obj with a <code>str</code> obj:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">u'Hello'</span> == <span class="string">'Hello'</span></span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Hello'</span> == <span class="string">u'Hello'</span></span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">u'Hello'</span> == <span class="string">'\x81\x01'</span> </span><br><span class="line">__main__:<span class="number">1</span>: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them <span class="keyword">as</span> being unequal</span><br><span class="line"><span class="keyword">False</span></span><br></pre></td></tr></table></figure>
<p>Compare a unicode object against a string which does not represent a valid UTF8 encoding, errors will be returned.</p>
<p>Compare <code>unicode</code> in a list:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> json</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = json.loads(<span class="string">'&#123;"number1":"first", "number2":"second", "number3":"third"&#125;'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[item <span class="keyword">for</span> item <span class="keyword">in</span> data <span class="keyword">if</span> item == <span class="string">"number1"</span>]</span><br><span class="line">[<span class="string">u'number1'</span>]</span><br><span class="line">[item <span class="keyword">for</span> item <span class="keyword">in</span> data <span class="keyword">if</span> <span class="keyword">not</span> item == <span class="string">u"number1"</span>]</span><br><span class="line">[<span class="string">u'number2'</span>, <span class="string">u'number3'</span>]</span><br></pre></td></tr></table></figure>
<p>When compare non-english letters, you need to <code>encode</code> or <code>decode</code> them to <code>str</code> or <code>unicode</code> firstly:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">u'了'</span> == <span class="string">'了'</span></span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">u'Hello'</span> == <span class="string">'Hello'</span></span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&gt;&gt;了<span class="string">' == '</span>了<span class="string">'.decode('</span>utf<span class="number">-8</span><span class="string">')</span></span><br><span class="line"><span class="string">True</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; u'</span>了<span class="string">'.encode('</span>utf<span class="number">-8</span><span class="string">') == '</span>了<span class="string">'</span></span><br><span class="line"><span class="string">True</span></span><br></pre></td></tr></table></figure>
<h3 id="Local-system-encoding"><a href="#Local-system-encoding" class="headerlink" title="Local system encoding"></a>Local system encoding</h3><p>Python command  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Python <span class="number">2.7</span><span class="number">.10</span> (default, Feb  <span class="number">7</span> <span class="number">2017</span>, <span class="number">00</span>:<span class="number">08</span>:<span class="number">15</span>) </span><br><span class="line">[GCC <span class="number">4.2</span><span class="number">.1</span> Compatible Apple LLVM <span class="number">8.0</span><span class="number">.0</span> (clang<span class="number">-800.0</span><span class="number">.34</span>)] on darwin</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> sys.getdefaultencoding()</span><br><span class="line">ascii</span><br></pre></td></tr></table></figure>
<p>Change ternimal’s encoding:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.setdefaultencoding(<span class="string">'UTF-8'</span>)</span><br></pre></td></tr></table></figure>
<p>When Unicode characters are printed to stdout, sys.stdout.encoding is used. A non-Unicode character is assumed to be in sys.stdout.encoding and is just sent to the terminal.  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> unicodedata <span class="keyword">as</span> ud</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.stdout.encoding</span><br><span class="line"><span class="string">'cp437'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ud.name(<span class="string">u'\xe9'</span>)</span><br><span class="line"><span class="string">'LATIN SMALL LETTER E WITH ACUTE'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ud.name(<span class="string">'\xe9'</span>.decode(<span class="string">'cp437'</span>))</span><br><span class="line"><span class="string">'GREEK CAPITAL LETTER THETA'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> unicodedata <span class="keyword">as</span> ud</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ud.name(<span class="string">u'\xe9'</span>)</span><br><span class="line"><span class="string">'LATIN SMALL LETTER E WITH ACUTE'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'\xe9'</span>.decode(<span class="string">'cp437'</span>)</span><br><span class="line"><span class="string">u'\u0398'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ud.name(<span class="string">u'\u0398'</span>)</span><br><span class="line"><span class="string">'GREEK CAPITAL LETTER THETA'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">u'\xe9'</span></span><br><span class="line">é</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> <span class="string">'\xe9'</span></span><br><span class="line">Θ</span><br></pre></td></tr></table></figure>
<p>As you may have noticed from the examples on this page, you can actually write Python scripts in UTF-8. Variables must be in ASCII, but you can include Chinese comments, or Korean strings in your source files. Errors will be retured:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File &quot;XXX.py&quot;, line 3</span><br><span class="line">SyntaxError: Non-ASCII character &apos;\xd6&apos; in file c.py on line 3, but no encoding declared; see http://www.python.org/peps/pep-0263.html for details</span><br></pre></td></tr></table></figure>
<p>In order for this to work correctly, Python needs to know that your script file is not ASCII. You can place the following special comment in the first or second lines of your script:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Reading-UTF-8-Files"><a href="#Reading-UTF-8-Files" class="headerlink" title="Reading UTF-8 Files"></a>Reading UTF-8 Files</h3><p>You can manually convert strings that you read from files, however there is an easier way:  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line">fileObj = codecs.open( <span class="string">"someFile"</span>, <span class="string">"r"</span>, <span class="string">"utf-8"</span> )</span><br><span class="line">u = fileObj.read() <span class="comment"># Returns a Unicode string from the UTF-8 bytes in the file</span></span><br></pre></td></tr></table></figure>
<p>The <a href="https://docs.python.org/2/library/codecs.html" target="_blank" rel="noopener">codecs module</a> will take care of all the conversions for you. You can also open a file for writing and it will convert the Unicode strings you pass in to write into whatever encoding you have chosen.</p>
<hr>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>[1] <a href="https://en.wikipedia.org/wiki/Unicode" target="_blank" rel="noopener">Unicode(Wikipedia)</a><br>[2] <a href="https://stackoverflow.com/questions/18034272/python-str-vs-unicode-types" target="_blank" rel="noopener">Python str vs unicode types</a><br>[3] <a href="https://liguangming.com/how-to-use-utf-8-with-python" target="_blank" rel="noopener">怎么在Python里使用UTF-8编码</a><br>[4] <a href="https://www.v2ex.com/t/163786" target="_blank" rel="noopener">有关 Python 2 和 Sublime Text 中文 Unicode 编码问题的分析与理解</a><br>[5] <a href="http://www.evanjones.ca/python-utf8.html" target="_blank" rel="noopener">How to Use UTF-8 with Python</a><br>[6] <a href="https://stackoverflow.com/questions/2596714/why-does-python-print-unicode-characters-when-the-default-encoding-is-ascii" target="_blank" rel="noopener">Why does Python print unicode characters when the default encoding is ASCII?</a><br>[7] <a href="https://gist.github.com/x7hub/178c87f323fbad57ff91" target="_blank" rel="noopener">Python2字符编码问题小结</a><br>[8] <a href="https://stackoverflow.com/questions/447107/what-is-the-difference-between-encode-decode" target="_blank" rel="noopener">What is the difference between encode/decode?</a><br>[9] <a href="https://stackoverflow.com/questions/18193305/python-unicode-equal-comparison-failed" target="_blank" rel="noopener">Python unicode equal comparison failed</a><br>[10] <a href="https://stackoverflow.com/questions/16471332/how-can-i-compare-a-unicode-type-to-a-string-in-python" target="_blank" rel="noopener">How can I compare a unicode type to a string in python?</a></p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/posts/28001/">Using Regular Expression to Filter Chinese</a><a class="next" href="/posts/43236/">How to Make Slides with CSS</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论 「请确保 disqus.com 可以正常加载」</button></div><script>var disqus_shortname = 'chenyuzuoo';
var disqus_identifier = 'posts/50024/';
var disqus_title = 'Python Encoding System';
var disqus_url = 'https://chenyuzuoo.github.io/posts/50024/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
$.ajax({
  url: 'https://disqus.com/next/config.json',
  timeout: 3000,
  type: 'GET',
  success: (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    $('.btn_click_load').css('display','none');
  })(),
  error: function() {
    $('.btn_click_load').css('display','block');
  }
});</script><script id="dsq-count-scr" src="//chenyuzuoo.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://chenyuzuoo.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ArcGIS/">ArcGIS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CSS/">CSS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Latex/">Latex</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network/">Network</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Others/">Others</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/R/">R</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Sublime/">Sublime</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Theory/">Theory</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/model/" style="font-size: 15px;">model</a> <a href="/tags/algorithm/" style="font-size: 15px;">algorithm</a> <a href="/tags/user-management/" style="font-size: 15px;">user management</a> <a href="/tags/tool/" style="font-size: 15px;">tool</a> <a href="/tags/design/" style="font-size: 15px;">design</a> <a href="/tags/pandas/" style="font-size: 15px;">pandas</a> <a href="/tags/error-shooting/" style="font-size: 15px;">error shooting</a> <a href="/tags/text-processing/" style="font-size: 15px;">text processing</a> <a href="/tags/installation/" style="font-size: 15px;">installation</a> <a href="/tags/listener/" style="font-size: 15px;">listener</a> <a href="/tags/ArcGIS-Pro/" style="font-size: 15px;">ArcGIS Pro</a> <a href="/tags/network/" style="font-size: 15px;">network</a> <a href="/tags/tools/" style="font-size: 15px;">tools</a> <a href="/tags/ArcGIS/" style="font-size: 15px;">ArcGIS</a> <a href="/tags/data-visualization/" style="font-size: 15px;">data visualization</a> <a href="/tags/Tomcat/" style="font-size: 15px;">Tomcat</a> <a href="/tags/PostgreSQL/" style="font-size: 15px;">PostgreSQL</a> <a href="/tags/GeoServer/" style="font-size: 15px;">GeoServer</a> <a href="/tags/Leaflet/" style="font-size: 15px;">Leaflet</a> <a href="/tags/Network/" style="font-size: 15px;">Network</a> <a href="/tags/web-mapping/" style="font-size: 15px;">web mapping</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/posts/18707/">Install Geopandas</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/31988/">Multiple Linear Regression in R</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/30557/">Spatial polygon area calculation by another polygon layer</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/17204/">How to Draw Interactive Steamgraph in R</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/39979/">Extract Column from Tables</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/38366/">Leaflet Overlay OnEachFeature</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/27622/">Control Leadlet Overlays</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/14057/">ArcGIS_admin Python Module is Online</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4483/">Shapefile Import Failed</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/35459/">Drop All Tables in PostgreSQL</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> Recent Comments</i></div><script type="text/javascript" src="//chenyuzuoo.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://qsli.github.io/" title="KL's Blog" target="_blank">KL's Blog</a><ul></ul><a href="https://shuoyanhuang.github.io/" title="S.Huang's Personal Page" target="_blank">S.Huang's Personal Page</a></div><div class="widget"><div class="widget-title"><i class="fa fa-view-o"> View Record</i></div></div>Total<span id="busuanzi_container_site_pv"><span> </span><span rel="nofollow" id="busuanzi_value_site_pv"></span><span rel="nofollow">  hits, </span></span><span id="busuanzi_container_site_uv"><span rel="nofollow" id="busuanzi_value_site_uv"></span><span rel="nofollow">  vistors.</span></span></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Chenyu's Script.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>